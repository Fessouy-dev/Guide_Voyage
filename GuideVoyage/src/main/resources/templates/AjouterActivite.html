<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title><!DOCTYPE html>
      <html lang="fr" xmlns:th="http://www.thymeleaf.org">
      <head>
      <meta charset="UTF-8">
      <title>Ajouter Activiter</title>
  <!-- Select2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <!-- jQuery (requis pour Select2) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- Select2 JS -->
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <style>
    .select2-container {
      width: 100% !important;
      margin-bottom: 15px;
    }
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    form {
      max-width: 600px;
      margin: 0 auto;
    }
    input, select {
      margin-bottom: 15px;
      padding: 8px;
      width: 100%;
    }
    .photo-container {
      margin-bottom: 15px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .photo-preview {
      max-width: 150px;
      max-height: 100px;
      margin-top: 8px;
      display: none;
    }
    .add-photo-btn {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 8px 16px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
      margin: 10px 0;
      cursor: pointer;
      border-radius: 4px;
    }
    .remove-photo-btn {
      background-color: #f44336;
      color: white;
      border: none;
      padding: 4px 8px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 12px;
      margin-left: 10px;
      cursor: pointer;
      border-radius: 4px;
    }
  </style>
</head>
<body>
<h1>Ajouter Activiter </h1>
<form th:action="@{/admin/Activites/Ajouter}" th:object="${activite}" method="post" enctype="multipart/form-data">
  <!-- Champs existants -->
  <label for="nom">Nom:</label>
  <input type="text" id="nom" name="nom" th:field="*{nom}" required/>
  <br/>

  <label for="description">Description:</label>
  <input type="text" id="description" name="description" th:field="*{description}" required/>
  <br/>

  <label for="localisation">Localisation:</label>
  <input type="text" id="localisation" name="localisation" th:field="*{localisation}" required/>
  <br/>

  <!-- Photo principale -->
  <label for="photoFile">Photo principale (.png):</label>
  <input type="file" id="photoFile" name="photoFile" accept=".png"/>
  <img id="preview-main" class="photo-preview"/>
  <br/>

  <!-- Photos additionnelles -->
  <h3>Photos additionnelles</h3>
  <div id="photos-container">
    <div class="photo-container">
      <label>Photo (.png):</label>
      <input type="file" name="additionalPhotos" accept=".png" class="photo-input" onchange="previewPhoto(this)"/>
      <img class="photo-preview"/>
      <button type="button" class="remove-photo-btn" onclick="removePhotoContainer(this)">Supprimer</button>
    </div>
  </div>

  <button type="button" class="add-photo-btn" id="add-photo-btn">Ajouter une autre photo</button>
  <br/>


  <label for="typeActivie">Type Activite:</label>
  <select id="typeActivie" name="typeActivie" th:field="*{typeActivie}" required>
    <option value="" disabled selected>-- Sélectionnez une Activiter --</option>
    <option th:each="type :${Activiter}"
            th:value="${type}"
            th:text="${type}">
    </option>
  </select>
  <br/>

  <!-- Ville information -->
  <h3>Ville</h3>
  <label for="villeNom">Nom de la ville:</label>
  <select id="villeNom" name="ville.nom" th:field="*{ville.nom}" required>
    <option value="" disabled selected>-- Sélectionnez une ville --</option>
    <option value="Casablanca">Casablanca</option>
    <option value="Rabat">Rabat</option>
    <option value="Marrakech">Marrakech</option>
    <option value="Fès">Fès</option>
    <option value="Tanger">Tanger</option>
    <option value="Meknès">Meknès</option>
    <option value="Agadir">Agadir</option>
    <option value="Oujda">Oujda</option>
    <option value="Kénitra">Kénitra</option>
    <option value="Tétouan">Tétouan</option>
    <option value="Safi">Safi</option>
    <option value="Mohammédia">Mohammédia</option>
    <option value="El Jadida">El Jadida</option>
    <option value="Béni Mellal">Béni Mellal</option>
    <option value="Nador">Nador</option>
  </select>
  <br/>

  <label for="villePays">Pays:</label>
  <input type="text" id="villePays" name="ville.pays" th:field="*{ville.pays}" value="Maroc" readonly required/>
  <br/>

  <button type="submit">Ajouter</button>
</form>

<script>
  $(document).ready(function() {
    // Initialisation de Select2 pour la ville
    $('#villeNom').select2({
      placeholder: "Rechercher une ville marocaine...",
      allowClear: true,
      language: {
        noResults: function() {
          return "Ville non trouvée";
        }
      }
    });

    // Preview pour la photo principale
    $("#photoFile").change(function() {
      readURL(this, "#preview-main");
    });

    // Ajouter une autre photo
    $("#add-photo-btn").click(function() {
      const photoContainer = `
                <div class="photo-container">
                    <label>Photo (.png):</label>
                    <input type="file" name="additionalPhotos" accept=".png" class="photo-input" onchange="previewPhoto(this)"/>
                    <img class="photo-preview"/>
                    <button type="button" class="remove-photo-btn" onclick="removePhotoContainer(this)">Supprimer</button>
                </div>
            `;
      $("#photos-container").append(photoContainer);
    });
  });

  // Fonction pour prévisualiser l'image principale
  function readURL(input, previewId) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function(e) {
        $(previewId).attr('src', e.target.result);
        $(previewId).css('display', 'block');
      }

      reader.readAsDataURL(input.files[0]);
    }
  }

  // Fonction pour prévisualiser les images additionnelles
  function previewPhoto(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function(e) {
        $(input).next('.photo-preview').attr('src', e.target.result);
        $(input).next('.photo-preview').css('display', 'block');
      }

      reader.readAsDataURL(input.files[0]);
    }
  }

  // Fonction pour supprimer un conteneur de photo
  function removePhotoContainer(button) {
    $(button).parent('.photo-container').remove();
  }
</script>
</body>
</html></title>
</head>
<body>

</body>
</html>